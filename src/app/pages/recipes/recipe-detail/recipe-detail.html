<div *ngIf="recipe as r; else notFound" class="recipe-detail">
  <div class="gold-gradient">Tu desaf√≠o del d√≠a</div>

  <!-- CARD -->
  <article class="recipe-card">
    <!-- SLIDER DE IM√ÅGENES -->
    <div class="image-slider" *ngIf="r.images && r.images.length; else placeholderImage">
      <button (click)="prevImage()">‚óÄ</button>
      <img [src]="r.images[currentImageIndex]" [alt]="r.title" class="slider-image" />
      <button (click)="nextImage()">‚ñ∂</button>
    </div>

    <ng-template #placeholderImage>
      <img src="assets/images/logo.webp" [alt]="r.title" class="slider-image" />
    </ng-template>

    <!-- RATING -->
    <div class="rating">
      <span
        class="star"
        *ngFor="let star of stars; let i = index"
        [class.filled]="i < (r.rating ?? 0)"
      >
        ‚òÖ
      </span>
    </div>

    <!-- LIKE -->
    <button
      class="like-fab"
      [class.active]="isFavorite"
      (click)="toggleFavorite()"
      aria-label="Me gusta"
    >
      ‚ù§Ô∏è<span class="likes-count">{{ likesCount }}</span>
    </button>

    <!-- COMPARTIR -->
    <button class="share-icon" (click)="shareRecipe()" aria-label="Compartir">üîó</button>

    <!-- CONTENIDO -->
    <div class="card-content">
      <h1>{{ r.title }}</h1>

      <!-- Descripci√≥n breve -->
      <p class="short-description">{{ r.shortDescription }}</p>

      <!-- Descripci√≥n paso a paso -->
      <section class="long-description">
        <h3>Preparaci√≥n</h3>
        <p>{{ r.longDescription }}</p>
      </section>

      <!-- Ingredientes -->
      <section class="ingredients">
        <h3>Ingredientes</h3>
        <ul>
          <li *ngFor="let ingredient of r.ingredients">{{ ingredient }}</li>
        </ul>
      </section>

      <!-- Autor -->
      <div class="author">
        <img [src]="r.author?.avatar || 'assets/images/profile.jpg'" alt="Autor" class="avatar" />
        <div class="author-info">
          <span class="author-name">{{ r.author?.name }}</span>
          <a class="author-link" [routerLink]="['/perfil', r.author?.id]">Ver sus recetas</a>
        </div>
      </div>
    </div>
  </article>

  <!-- BACK BUTTON -->
  <app-back-button [fallbackRoute]="'/inicio'"></app-back-button>
</div>

<ng-template #notFound>
  <div class="recipe-not-found">
    <p>Esta receta no existe o ya no est√° disponible.</p>
    <button class="back-button" routerLink="/inicio">‚Üê Volver al inicio</button>
  </div>
</ng-template>
